# Web 功能自动化测试工具

一个功能强大的 Chrome 浏览器插件，可以自动化测试网页的所有功能按钮，监控 API 请求，并生成详细的可视化测试报告。

## 📚 快速链接

- **🚀 快速开始**：[QUICK_REFERENCE.md](QUICK_REFERENCE.md) - 快速参考卡（5分钟上手）
- **📖 完整指南**：[QUICK_TEST_GUIDE.md](QUICK_TEST_GUIDE.md) - 详细使用指南
- **🔧 技术规格**：[WORKFLOW_TEST_REPORT.md](WORKFLOW_TEST_REPORT.md) - 三阶段工作流技术规格
- **✅ 完成报告**：[COMPLETION_REPORT_2026_01_12.md](COMPLETION_REPORT_2026_01_12.md) - 最终完成报告
- **📋 执行摘要**：[EXECUTIVE_SUMMARY.md](EXECUTIVE_SUMMARY.md) - 核心成果一览

## 功能特性

### 🎯 核心功能

- **自动化元素识别**：智能识别网页上的所有可交互元素（按钮、链接、表单等）
- **自动化测试执行**：逐个点击和操作所有元素，模拟真实用户交互
- **API 监控**：实时拦截和监控所有网络请求（Fetch 和 XMLHttpRequest）
- **错误追踪**：捕获测试过程中的错误和异常
- **可视化报告**：生成包含图表、统计数据的专业测试报告

### 📊 报告生成

- **统计概览**：测试元素总数、成功率、失败数、API 错误数
- **饼图展示**：测试结果分布（成功 vs 失败）
- **柱状图**：按元素类型分类统计
- **API 分析**：请求总数、HTTP 状态码分类统计
- **详细表格**：所有测试元素和 API 请求的详细信息
- **导出功能**：支持 JSON、CSV 格式导出及打印

### ⚙️ 配置选项

- ✓ 测试交互按钮
- ✓ 监控 API 请求
- ✓ 捕获截图
- ✓ 捕获控制台日志

## 项目结构

```
web-test-automation/
├── manifest.json              # Chrome扩展清单文件
├── src/
│   ├── popup.html            # 弹窗UI界面
│   ├── popup.css             # 弹窗样式
│   ├── popup.js              # 弹窗逻辑
│   ├── content-script.js     # 内容脚本（在页面中执行）
│   ├── background.js         # 后台服务worker
│   ├── report.html           # 测试报告页面
│   ├── report.css            # 报告样式
│   └── report.js             # 报告逻辑
└── README.md                 # 本文件
```

## 安装方法

### 方式一：开发者模式安装（推荐）

1. 打开 Chrome 浏览器，进入扩展程序页面

   - 地址栏输入：`chrome://extensions/`

2. 打开右上角的"开发者模式"开关

3. 点击"加载已解压的扩展程序"

4. 选择 `web-test-automation` 文件夹

5. 完成！插件已安装到你的 Chrome 浏览器中

### 方式二：生成 CRX 文件（发布）

1. 在 `chrome://extensions/` 页面
2. 右键点击已加载的扩展
3. 选择"导出扩展程序"
4. 保存生成的.crx 文件

## 使用步骤

### 1. 启动测试

- 点击浏览器右上角的插件图标，打开插件弹窗
- 在"目标网址"输入框中输入要测试的网址（如 `https://www.example.com`）
- 在“智能测试助手”中描述你的测试意图（例如：注册与登录、加购到结算、管理后台基础操作）
- 两种方式启动：
  - 点击“让 AI 智能分析”：由 AI 理解意图并生成测试计划后执行
  - 点击“使用快速模式”：跳过意图分析，直接按当前配置开始测试

### 2. 实时监控

- 插件会自动在新标签页打开目标网址
- 实时显示测试进度和统计数据：
  - 已测试按钮数
  - 测试成功数
  - 测试失败数
  - API 错误数
- 同步显示详细的操作日志

### 3. 查看报告

- 等待测试完成后，点击"查看报告"按钮
- 或者在新标签页中查看完整的可视化报告

## 报告功能详解

### 📈 统计概览卡片

- **测试元素总数**：网页中识别到的可交互元素总数
- **测试成功**：成功操作的元素数
- **测试失败**：操作失败的元素数
- **API 错误**：发生错误的 API 请求数

### 📊 图表分析

- **结果分布饼图**：直观展示成功率
- **元素类型柱状图**：统计各类型元素的分布

### 🌐 API 分析

- **HTTP 状态码分类**：
  - 2xx (200-299)：成功
  - 3xx (300-399)：重定向
  - 4xx (400-499)：客户端错误
  - 5xx (500-599)：服务器错误

### 📋 详细数据表

- **元素详情表**：列出所有测试元素及其选择器
- **请求详情表**：显示所有 API 请求的详细信息

### 💾 导出选项

- **导出 JSON**：完整的测试数据
- **导出 CSV**：可在 Excel 中打开
- **打印报告**：生成 PDF 或纸质报告

## 工作流程

```
1. 用户输入URL
   ↓
2. 插件打开目标网页
   ↓
3. Content Script加载，识别所有可交互元素
   ↓
4. 逐个执行元素操作（点击、输入等）
   ↓
5. 实时监控API请求和响应
   ↓
6. 收集错误和日志信息
   ↓
7. 生成可视化测试报告
   ↓
8. 支持导出和打印
```

## 技术架构

### 使用的技术

- **Chrome Extension Manifest V3**：最新的扩展开发标准
- **Content Script**：在页面上下文中执行，操纵 DOM
- **Service Worker**：后台处理和消息转发
- **Fetch/XHR 拦截**：监控网络请求
- **Chart.js**：绘制可视化图表
- **Native CSS3**：响应式设计

### 核心组件

#### 1. Popup（弹窗）

- 用户界面入口
- 配置选项管理
- 实时进度显示
- 操作日志输出

#### 2. Content Script（内容脚本）

- 识别 DOM 中的可交互元素
- 执行自动化操作（点击、输入等）
- 拦截 Fetch 和 XHR 请求
- 收集测试数据

#### 3. Background Service Worker

- 消息中转站
- 存储测试数据
- 生命周期管理

#### 4. Report（报告生成器）

- 读取测试数据
- 生成图表
- 导出数据
- 打印功能

## API 拦截原理

插件通过以下方式监控所有网络请求：

```javascript
// Fetch拦截
window.fetch = function (...args) {
  // 记录请求
  // 执行原始fetch
  // 记录响应
};

// XHR拦截
XMLHttpRequest.prototype.open = function (method, url) {
  // 记录请求信息
};

XMLHttpRequest.prototype.send = function () {
  // 监听响应
};
```

## 元素识别规则

插件识别以下类型的元素：

1. **按钮元素**

   - `<button>`
   - `<a role="button">`
   - `<input type="button">`
   - `<input type="submit">`

2. **链接元素**

   - `<a>` with href

3. **表单输入**
   - `<input>` (text, email, password, search)
   - `<textarea>`
   - `<select>`

只识别**可见**的元素（offsetParent !== null）

## 测试场景

该工具适合以下场景：

- ✅ 新网站上线前的功能测试
- ✅ 网站大规模更新后的回归测试
- ✅ 页面的可交互性质量保证
- ✅ API 集成测试
- ✅ 性能基准测试（可扩展）
- ✅ 跨浏览器兼容性测试（基于 Chrome）

## 限制和说明

1. **单一标签页测试**：一次只能测试一个网址
2. **Chrome 限制**：只能在 Chrome 浏览器中使用
3. **权限范围**：所有 URL（需用户授权）
4. **跨域限制**：遵守浏览器 CORS 政策
5. **Element 查找**：基于 DOM 结构，可能遗漏动态加载的元素

## 常见问题

### Q: 测试过程中出现"无法连接到页面"

A: 页面可能加载失败或 URL 格式不正确。请检查：

- URL 格式是否正确（包含 http://或 https://）
- 网络连接是否正常
- 网站是否能正常访问

### Q: 为什么某些按钮没有被识别？

A: 可能原因：

- 按钮可能是通过 JavaScript 动态生成的
- 按钮可能隐藏或不可见
- 按钮可能在 iframe 中（需要特殊处理）

### Q: API 错误很多，是网站问题还是插件问题？

A: 检查以下情况：

- 在浏览器开发者工具中检查 Network 标签
- 查看报告中的具体 API 请求 URL
- 确认目标网站 API 是否正常工作

### Q: 如何使用报告中的数据？

A: 可以：

- 直接在报告页面查看可视化数据
- 导出 JSON 用于自动化分析
- 导出 CSV 用于 Excel 处理
- 打印成 PDF 进行存档

## 开发和扩展

### 修改插件代码

1. 编辑文件后，无需重新安装
2. 在 `chrome://extensions/` 页面点击刷新即可加载最新代码
3. 使用浏览器开发者工具调试：
   - Content Script：在目标网页按 F12
   - Service Worker：在扩展管理页面点击"Service Worker"

### 自定义测试逻辑

编辑 `src/content-script.js`：

- 修改 `getInteractiveElements()` 改变元素识别规则
- 修改 `performInteraction()` 改变交互方式
- 添加新的数据收集逻辑

### 自定义报告样式

编辑 `src/report.css`：

- 修改颜色和字体
- 调整布局
- 添加新的组件样式

## 故障排除

### 插件无法加载

- 检查 manifest.json 语法
- 确保所有文件都在正确的路径
- 查看扩展程序页面的错误信息

### 测试无法开始

- 检查 popup.js 中的消息发送
- 查看 background worker 的日志
- 在 content script 中添加 console.log 调试

### 报告无法显示

- 检查浏览器控制台错误
- 确认 storage 数据是否保存
- 检查 report.js 中的数据读取逻辑

## 许可证

MIT License - 可自由使用和修改

## 联系和支持

如有问题或建议，请：

- 查看插件代码注释
- 检查浏览器开发者工具的错误信息
- 根据错误信息调试相关文件

---

**版本**：1.0.0
**最后更新**：2024 年 1 月
**作者**：Web Testing Tool Team
