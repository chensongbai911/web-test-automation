# ğŸ¤– é€šä¹‰åƒé—®Plusæ·±åº¦èµ‹èƒ½Webè‡ªåŠ¨åŒ–æµ‹è¯• - å®Œæ•´ä¼˜åŒ–æ–¹æ¡ˆ

**é¡¹ç›®**:  chensongbai911/web-test-automation  
**å¤§æ¨¡å‹**: é€šä¹‰åƒé—®Plus (Qwen-Plus)  
**ä¼˜åŒ–ç›®æ ‡**: å®ç°çœŸæ­£çš„æ™ºèƒ½åŒ–æµ‹è¯•ï¼Œä»"è‡ªåŠ¨åŒ–"åˆ°"æ™ºèƒ½åŒ–"çš„è´¨å˜å‡çº§  
**æ–‡æ¡£ç‰ˆæœ¬**: v2.0  
**æ—¥æœŸ**: 2026-01-12

---

## ğŸ“‹ ç›®å½•

1. [æ‰§è¡Œæ‘˜è¦](#æ‰§è¡Œæ‘˜è¦)
2. [AIèµ‹èƒ½å…¨æ™¯å›¾](#aièµ‹èƒ½å…¨æ™¯å›¾)
3. [å…­å¤§æ ¸å¿ƒä¼˜åŒ–æ–¹å‘](#å…­å¤§æ ¸å¿ƒä¼˜åŒ–æ–¹å‘)
4. [å®Œæ•´å®æ–½æ–¹æ¡ˆ](#å®Œæ•´å®æ–½æ–¹æ¡ˆ)
5. [ä»£ç å®ç°è¯¦è§£](#ä»£ç å®ç°è¯¦è§£)
6. [æµ‹è¯•è´¨é‡ä¿éšœä½“ç³»](#æµ‹è¯•è´¨é‡ä¿éšœä½“ç³»)
7. [å®æ–½è·¯çº¿å›¾](#å®æ–½è®¡åˆ’roadmap)

---

# ğŸ¤– é€šä¹‰åƒé—®Plusæ·±åº¦èµ‹èƒ½Webè‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·

## äº§å“ä¼˜åŒ–æ–¹æ¡ˆ v2.0

**é¡¹ç›®**: chensongbai911/web-test-automation  
**ä¼˜åŒ–æ–¹å‘**: AIå…¨æµç¨‹æ·±åº¦é›†æˆ  
**ç›®æ ‡**: æ‰“é€ ä¸šç•Œé¢†å…ˆçš„AIé©±åŠ¨æ™ºèƒ½æµ‹è¯•å·¥å…·  
**æ’°å†™äºº**: äº§å“ç­–ç•¥å›¢é˜Ÿ  
**æ—¥æœŸ**: 2026-01-12

---

## ğŸ“Š æ‰§è¡Œæ‘˜è¦

### å½“å‰AIé›†æˆç°çŠ¶è¯„ä¼°

ç»è¿‡æ·±å…¥ä»£ç å®¡æŸ¥ï¼Œé¡¹ç›®å·²å…·å¤‡ä»¥ä¸‹AIèƒ½åŠ›ï¼š

**âœ… å·²å®ç°çš„AIåŠŸèƒ½**
- âœ… æ™ºèƒ½æµ‹è¯•ç­–ç•¥ç”Ÿæˆ (`ai-test-orchestrator.js`)
- âœ… åŠ¨æ€å…ƒç´ æ™ºèƒ½å®šä½
- âœ… å¼‚å¸¸æ™ºèƒ½è¯Šæ–­ä¸è‡ªæ„ˆ
- âœ… æ™ºèƒ½æµ‹è¯•æ•°æ®ç”Ÿæˆ
- âœ… æµ‹è¯•ç»“æœæ·±åº¦åˆ†æ
- âœ… ä¸šåŠ¡æµç¨‹ç†è§£

**âŒ ä½†å­˜åœ¨çš„é—®é¢˜**
1. **AIèƒ½åŠ›ç¢ç‰‡åŒ–** - å„ä¸ªAIåŠŸèƒ½ç‹¬ç«‹ï¼Œç¼ºä¹ç»Ÿä¸€ç¼–æ’
2. **è¢«åŠ¨å¼è°ƒç”¨** - AIåªåœ¨ç‰¹å®šèŠ‚ç‚¹è¢«è°ƒç”¨ï¼Œæœªè´¯ç©¿å…¨æµç¨‹
3. **ä¸Šä¸‹æ–‡ä¸è¿è´¯** - æ¯æ¬¡AIè°ƒç”¨éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œç¼ºå°‘è®°å¿†
4. **å†³ç­–ä¸é—­ç¯** - AIç»™å‡ºå»ºè®®ï¼Œä½†æœªè‡ªåŠ¨æ‰§è¡Œå’ŒéªŒè¯
5. **å­¦ä¹ èƒ½åŠ›ç¼ºå¤±** - AIæ— æ³•ä»å†å²æµ‹è¯•ä¸­å­¦ä¹ å’Œä¼˜åŒ–

æˆ‘éœ€è¦è®¾è®¡ä¸€ä¸ªå®Œæ•´çš„"AI-First"æµ‹è¯•æ¶æ„ï¼Œè®©é€šä¹‰åƒé—®Plusè´¯ç©¿æ•´ä¸ªæµ‹è¯•ç”Ÿå‘½å‘¨æœŸã€‚
</thinking>

æˆ‘ä¼šä»¥ä¸€ä¸ªä¼˜ç§€çš„äº§å“ç»ç†å’Œäº§å“è®¾è®¡å¸ˆçš„è§’åº¦ï¼Œæ·±å…¥åˆ†æå¦‚ä½•è®©é€šä¹‰åƒé—®Pluså¤§æ¨¡å‹**æ·±åº¦èµ‹èƒ½**æ•´ä¸ªæµ‹è¯•æµç¨‹ï¼Œæ‰“é€ çœŸæ­£æ™ºèƒ½åŒ–ã€é«˜è´¨é‡çš„æµ‹è¯•å·¥å…·ã€‚

````markdown name=QWEN_PLUS_FULL_AI_ENHANCEMENT_PLAN.md
# ğŸ¤– é€šä¹‰åƒé—®Plusèµ‹èƒ½Webè‡ªåŠ¨åŒ–æµ‹è¯• - å®Œæ•´æ™ºèƒ½åŒ–æ–¹æ¡ˆ

**é¡¹ç›®**: chensongbai911/web-test-automation  
**ç‰ˆæœ¬**: v3.0 - AI Native  
**æ—¥æœŸ**: 2026-01-12  
**ä½œè€…**: AIäº§å“æ¶æ„å¸ˆ & äº§å“è®¾è®¡å¸ˆå›¢é˜Ÿ

---

## ğŸ“‹ ç›®å½•

1. [æ„¿æ™¯ä¸ç›®æ ‡](#æ„¿æ™¯ä¸ç›®æ ‡)
2. [AIèµ‹èƒ½å…¨æ™¯å›¾](#aièµ‹èƒ½å…¨æ™¯å›¾)
3. [æ ¸å¿ƒAIèƒ½åŠ›çŸ©é˜µ](#æ ¸å¿ƒaièƒ½åŠ›çŸ©é˜µ)
4. [æ·±åº¦ä¼˜åŒ–æ–¹æ¡ˆ](#æ·±åº¦ä¼˜åŒ–æ–¹æ¡ˆ)
5. [AI Promptå·¥ç¨‹](#ai-promptå·¥ç¨‹)
6. [ç”¨æˆ·ä½“éªŒè®¾è®¡](#ç”¨æˆ·ä½“éªŒè®¾è®¡)
7. [å®æ–½è·¯çº¿å›¾](#å®æ–½è·¯çº¿å›¾)

---

# ğŸ¤– é€šä¹‰åƒé—®Plusæ·±åº¦èµ‹èƒ½è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·
## AI Native Testing Platform - å®Œæ•´ä¼˜åŒ–æ–¹æ¡ˆ

**é¡¹ç›®**: chensongbai911/web-test-automation  
**æ–‡æ¡£ç‰ˆæœ¬**: v2.0 - AIæ·±åº¦èµ‹èƒ½ç‰ˆ  
**åˆ›å»ºæ—¥æœŸ**: 2026-01-12  
**ä½œè€…**:  AIäº§å“è®¾è®¡å›¢é˜Ÿ  

---

## ğŸ“‹ ç›®å½•

1. [æ‰§è¡Œæ‘˜è¦](#æ‰§è¡Œæ‘˜è¦)
2. [å½“å‰AIèƒ½åŠ›è¯„ä¼°](#å½“å‰aièƒ½åŠ›è¯„ä¼°)
3. [AIèµ‹èƒ½å…¨æ™¯å›¾](#aièµ‹èƒ½å…¨æ™¯å›¾)
4. [æ ¸å¿ƒä¼˜åŒ–æ–¹æ¡ˆ](#æ ¸å¿ƒä¼˜åŒ–æ–¹æ¡ˆ)
5. [å®æ–½è·¯çº¿å›¾](#å®æ–½è·¯çº¿å›¾)
6. [æŠ€æœ¯å®ç°ç»†èŠ‚](#æŠ€æœ¯å®ç°ç»†èŠ‚)
7. [æµ‹è¯•è´¨é‡ä¿éšœ](#æµ‹è¯•è´¨é‡ä¿éšœ)
8. [ç”¨æˆ·ä½“éªŒè®¾è®¡](#ç”¨æˆ·ä½“éªŒè®¾è®¡)

---

## ğŸ“Š æ‰§è¡Œæ‘˜è¦

### ç°çŠ¶åˆ†æ

**å½“å‰AIé›†æˆç¨‹åº¦**:  40%  
**AIèƒ½åŠ›åˆ©ç”¨ç‡**: 30%  
**æ™ºèƒ½åŒ–æ°´å¹³**: ä¸­ç­‰

ç»è¿‡æ·±å…¥åˆ†æï¼Œé¡¹ç›®å·²å…·å¤‡è‰¯å¥½çš„AIåŸºç¡€è®¾æ–½ï¼š
- âœ… å·²é›†æˆé€šä¹‰åƒé—®Plus (`qwen-integration. js`)
- âœ… å·²æœ‰AIæµ‹è¯•ç¼–æ’å™¨ï¼ˆ`ai-test-orchestrator.js`ï¼‰
- âœ… å…·å¤‡6å¤§æ ¸å¿ƒAIèƒ½åŠ›

**ä½†å­˜åœ¨ä»¥ä¸‹é—®é¢˜**:
1. âŒ AIèƒ½åŠ›è°ƒç”¨é¢‘ç‡ä½ï¼Œå¤§éƒ¨åˆ†æµç¨‹ä»æ˜¯è§„åˆ™é©±åŠ¨
2. âŒ AIå†³ç­–ç»“æœæœªå……åˆ†åˆ©ç”¨ï¼Œç¼ºå°‘å­¦ä¹ å’Œä¼˜åŒ–
3. âŒ ç¼ºå°‘AIå…¨æµç¨‹é—­ç¯ï¼ˆè§„åˆ’â†’æ‰§è¡Œâ†’åˆ†æâ†’ä¼˜åŒ–ï¼‰
4. âŒ Promptå·¥ç¨‹ä¸å¤Ÿç²¾ç»†ï¼ŒAIè¾“å‡ºè´¨é‡ä¸ç¨³å®š

ç°åœ¨æˆ‘å°†è®¾è®¡ä¸€ä»½å®Œæ•´çš„AIèµ‹èƒ½æ–¹æ¡ˆï¼Œè®©é€šä¹‰åƒé—®PlusçœŸæ­£æˆä¸ºæµ‹è¯•å·¥å…·çš„"å¤§è„‘"ã€‚
</thinking>

æˆ‘å°†ä¸ºæ‚¨åˆ›å»ºä¸€ä»½å®Œæ•´çš„ã€ä»¥AIä¸ºæ ¸å¿ƒçš„æµ‹è¯•å·¥å…·ä¼˜åŒ–æ–¹æ¡ˆï¼Œå……åˆ†å‘æŒ¥é€šä¹‰åƒé—®Pluså¤§æ¨¡å‹çš„èƒ½åŠ›ï¼Œå®ç°çœŸæ­£çš„æ™ºèƒ½åŒ–æµ‹è¯•ã€‚

````markdown name=AI_POWERED_TESTING_OPTIMIZATION_PLAN.md
# ğŸ¤– åŸºäºé€šä¹‰åƒé—®Plusçš„æ™ºèƒ½åŒ–æµ‹è¯•å·¥å…· - å®Œæ•´ä¼˜åŒ–æ–¹æ¡ˆ

**é¡¹ç›®**:  chensongbai911/web-test-automation  
**ç‰ˆæœ¬**: v3.0 - AI Native Edition  
**æ—¥æœŸ**: 2026-01-12  
**ä½œè€…**: AIäº§å“ä¼˜åŒ–å›¢é˜Ÿ

---

## ğŸ“‹ ç›®å½•

1. [æˆ˜ç•¥æ„¿æ™¯](#æˆ˜ç•¥æ„¿æ™¯)
2. [AIèƒ½åŠ›å…¨æ™¯å›¾](#aièƒ½åŠ›å…¨æ™¯å›¾)
3. [æ ¸å¿ƒä¼˜åŒ–æ–¹æ¡ˆ](#æ ¸å¿ƒä¼˜åŒ–æ–¹æ¡ˆ)
4. [æ™ºèƒ½åŒ–æµ‹è¯•æµç¨‹é‡æ„](#æ™ºèƒ½åŒ–æµ‹è¯•æµç¨‹é‡æ„)
5. [AI Promptå·¥ç¨‹ä½“ç³»](#ai-promptå·¥ç¨‹ä½“ç³»)
6. [è´¨é‡ä¿éšœæœºåˆ¶](#è´¨é‡ä¿éšœæœºåˆ¶)
7. [å®æ–½è·¯çº¿å›¾](#å®æ–½è·¯çº¿å›¾)
8. [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)

---

## ğŸ¯ æˆ˜ç•¥æ„¿æ™¯

### ä»"å·¥å…·è¾…åŠ©"åˆ°"AIé©±åŠ¨"

**å½“å‰çŠ¶æ€ (v2.0)**:
```
äººç±» ğŸ§‘ -> åˆ¶å®šæµ‹è¯•è®¡åˆ’ -> å·¥å…· ğŸ”§ -> æ‰§è¡Œæµ‹è¯• -> ç”ŸæˆæŠ¥å‘Š
                     â†‘
                 AIè¾…åŠ©åˆ†æï¼ˆè¢«åŠ¨ï¼‰
```

**ç›®æ ‡çŠ¶æ€ (v3.0)**:
```
äººç±» ğŸ§‘ -> è¾“å…¥æµ‹è¯•æ„å›¾ -> AI ğŸ¤– -> ç†è§£ã€è§„åˆ’ã€æ‰§è¡Œã€ä¼˜åŒ– -> æ™ºèƒ½æŠ¥å‘Š
                                  â†“
                          æŒç»­å­¦ä¹ å’Œè‡ªæˆ‘ä¼˜åŒ–
```

### æ ¸å¿ƒç†å¿µï¼šAI-First Testing

1. **AIç†è§£æµ‹è¯•æ„å›¾** - ä»è‡ªç„¶è¯­è¨€æè¿°ç”Ÿæˆæµ‹è¯•è®¡åˆ’
2. **AIè‡ªä¸»å†³ç­–** - æµ‹è¯•è¿‡ç¨‹ä¸­çš„æ‰€æœ‰å…³é”®å†³ç­–ç”±AIé©±åŠ¨
3. **AIæŒç»­å­¦ä¹ ** - ä»æµ‹è¯•ç»“æœä¸­å­¦ä¹ ï¼Œä¸æ–­ä¼˜åŒ–ç­–ç•¥
4. **AIè´¨é‡ä¿éšœ** - æ™ºèƒ½æ£€æµ‹æµ‹è¯•è´¨é‡é—®é¢˜å¹¶è‡ªåŠ¨ä¿®å¤

---

## ğŸ—ºï¸ AIèƒ½åŠ›å…¨æ™¯å›¾

### æµ‹è¯•å…¨ç”Ÿå‘½å‘¨æœŸAIèµ‹èƒ½

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AIå¢å¼ºæµ‹è¯•å¹³å°æ¶æ„                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  ğŸ“‹ æµ‹è¯•è§„åˆ’é˜¶æ®µ                                              â”‚
â”‚  â”œâ”€ AIæ„å›¾ç†è§£å¼•æ“                                           â”‚
â”‚  â”œâ”€ æ™ºèƒ½æµ‹è¯•è®¡åˆ’ç”Ÿæˆ                                         â”‚
â”‚  â”œâ”€ é¡µé¢ç»“æ„æ·±åº¦åˆ†æ                                         â”‚
â”‚  â””â”€ æµ‹è¯•åœºæ™¯æ™ºèƒ½æ¨è                                         â”‚
â”‚                                                               â”‚
â”‚  ğŸ” æµ‹è¯•å‡†å¤‡é˜¶æ®µ                                              â”‚
â”‚  â”œâ”€ æ™ºèƒ½å…ƒç´ è¯†åˆ«ï¼ˆè§†è§‰+è¯­ä¹‰ï¼‰                                â”‚
â”‚  â”œâ”€ æµ‹è¯•æ•°æ®æ™ºèƒ½ç”Ÿæˆ                                         â”‚
â”‚  â”œâ”€ ç¯å¢ƒé¢„æ£€å’Œä¼˜åŒ–å»ºè®®                                       â”‚
â”‚  â””â”€ é£é™©é¢„è¯„ä¼°                                               â”‚
â”‚                                                               â”‚
â”‚  âš¡ æµ‹è¯•æ‰§è¡Œé˜¶æ®µ                                              â”‚
â”‚  â”œâ”€ å®æ—¶å†³ç­–å¼•æ“                                             â”‚
â”‚  â”œâ”€ åŠ¨æ€è·¯å¾„è§„åˆ’                                             â”‚
â”‚  â”œâ”€ å¼‚å¸¸æ™ºèƒ½å¤„ç†                                             â”‚
â”‚  â”œâ”€ è·¨é¡µé¢çŠ¶æ€ç®¡ç†                                           â”‚
â”‚  â””â”€ å¹¶å‘æµ‹è¯•åè°ƒ                                             â”‚
â”‚                                                               â”‚
â”‚  ğŸ“Š ç»“æœåˆ†æé˜¶æ®µ                                              â”‚
â”‚  â”œâ”€ å¤šç»´åº¦è´¨é‡åˆ†æ                                           â”‚
â”‚  â”œâ”€ æ ¹å› æ™ºèƒ½è¯Šæ–­                                             â”‚
â”‚  â”œâ”€ æ”¹è¿›å»ºè®®ç”Ÿæˆ                                             â”‚
â”‚  â””â”€ è¶‹åŠ¿é¢„æµ‹å’Œé¢„è­¦                                           â”‚
â”‚                                                               â”‚
â”‚  ğŸ”„ æŒç»­ä¼˜åŒ–é˜¶æ®µ                                              â”‚
â”‚  â”œâ”€ çŸ¥è¯†åº“è‡ªåŠ¨æ›´æ–°                                           â”‚
â”‚  â”œâ”€ ç­–ç•¥è‡ªé€‚åº”è°ƒæ•´                                           â”‚
â”‚  â”œâ”€ æœ€ä½³å®è·µæç‚¼                                             â”‚
â”‚  â””â”€ æ¨¡å‹å¾®è°ƒ                                                 â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ æ ¸å¿ƒä¼˜åŒ–æ–¹æ¡ˆ

### ä¼˜åŒ–1: AIæµ‹è¯•æ„å›¾ç†è§£å¼•æ“ â­â­â­â­â­

#### é—®é¢˜å®šä¹‰

**å½“å‰**:  ç”¨æˆ·éœ€è¦è¯¦ç»†é…ç½®æµ‹è¯•å‚æ•°
```javascript
// ç”¨æˆ·å¿…é¡»æ˜ç¡®æŒ‡å®š
{
  testButtons: true,
  testForms: true,
  testLinks: true,
  delay: 800,
  maxElements: 100
}
```

**ç›®æ ‡**: ç”¨æˆ·åªéœ€æè¿°æƒ³åšä»€ä¹ˆ
```javascript
// ç”¨æˆ·è¾“å…¥è‡ªç„¶è¯­è¨€
"æˆ‘æƒ³æµ‹è¯•è¿™ä¸ªç”µå•†ç½‘ç«™çš„è´­ç‰©æµç¨‹ï¼Œç¡®ä¿ç”¨æˆ·èƒ½é¡ºåˆ©ä¸‹å•"
```

#### è§£å†³æ–¹æ¡ˆï¼šè‡ªç„¶è¯­è¨€åˆ°æµ‹è¯•è®¡åˆ’çš„è½¬æ¢

```javascript
// æ–°æ–‡ä»¶:  src/ai-intent-engine.js

/**
 * AIæµ‹è¯•æ„å›¾ç†è§£å¼•æ“
 * æ ¸å¿ƒèŒè´£ï¼š
 * 1. ç†è§£ç”¨æˆ·çš„è‡ªç„¶è¯­è¨€æµ‹è¯•æ„å›¾
 * 2. è½¬æ¢ä¸ºç»“æ„åŒ–çš„æµ‹è¯•è®¡åˆ’
 * 3. è‡ªåŠ¨æ¨æ–­æœ€ä½³æµ‹è¯•å‚æ•°
 */
class AIIntentEngine {
  constructor(qwenApiKey) {
    this.qwen = new QwenIntegration(qwenApiKey);
    this.intentHistory = [];
    this.contextMemory = new Map();
  }

  /**
   * æ ¸å¿ƒæ–¹æ³•ï¼šç†è§£æµ‹è¯•æ„å›¾
   */
  async understandIntent(userInput, pageContext) {
    console.log('[AIæ„å›¾å¼•æ“] å¼€å§‹ç†è§£ç”¨æˆ·æ„å›¾.. .');
    
    const prompt = `ä½ æ˜¯ä¸€ä½èµ„æ·±çš„QAæµ‹è¯•ä¸“å®¶ã€‚è¯·ç†è§£ç”¨æˆ·çš„æµ‹è¯•éœ€æ±‚å¹¶ç”Ÿæˆè¯¦ç»†çš„æµ‹è¯•è®¡åˆ’ã€‚

**ç”¨æˆ·è¾“å…¥**: "${userInput}"

**é¡µé¢ä¿¡æ¯**:
- URL: ${pageContext.url}
- æ ‡é¢˜: ${pageContext.title}
- é¡µé¢ç±»å‹: ${this.detectPageType(pageContext)}
- ä¸»è¦å…ƒç´ : ${this.summarizeElements(pageContext)}

**ä»»åŠ¡**:
1. **ç†è§£ç”¨æˆ·æ„å›¾**
   - ç”¨æˆ·æƒ³æµ‹è¯•ä»€ä¹ˆåŠŸèƒ½ï¼Ÿ
   - æµ‹è¯•çš„ç›®æ ‡æ˜¯ä»€ä¹ˆï¼Ÿ
   - æµ‹è¯•çš„ä¼˜å…ˆçº§å¦‚ä½•ï¼Ÿ
   - æµ‹è¯•çš„èŒƒå›´æœ‰å¤šå¤§ï¼Ÿ

2. **åˆ†æé¡µé¢ç‰¹å¾**
   - è¿™æ˜¯ä»€ä¹ˆç±»å‹çš„ç½‘ç«™ï¼Ÿï¼ˆç”µå•†ã€ç¤¾äº¤ã€ä¼ä¸šå®˜ç½‘ã€SaaSç­‰ï¼‰
   - é¡µé¢çš„æ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Ÿ
   - å“ªäº›å…ƒç´ æ˜¯å…³é”®çš„ï¼Ÿ

3. **ç”Ÿæˆæµ‹è¯•ç­–ç•¥**
   - éœ€è¦æµ‹è¯•å“ªäº›äº¤äº’å…ƒç´ ï¼Ÿ
   - éœ€è¦æµ‹è¯•å“ªäº›ä¸šåŠ¡æµç¨‹ï¼Ÿ
   - éœ€è¦éªŒè¯å“ªäº›æ•°æ®ï¼Ÿ
   - å¯èƒ½é‡åˆ°ä»€ä¹ˆé—®é¢˜ï¼Ÿ

4. **æ¨èæµ‹è¯•å‚æ•°**
   - æµ‹è¯•æ·±åº¦ï¼ˆæµ…å±‚/ä¸­å±‚/æ·±å±‚ï¼‰
   - æµ‹è¯•å¹¿åº¦ï¼ˆå•é¡µ/è·¨é¡µ/å…¨ç«™ï¼‰
   - æµ‹è¯•é€Ÿåº¦ï¼ˆå¿«é€Ÿ/æ ‡å‡†/ç»†è‡´ï¼‰
   - ç‰¹æ®Šé…ç½®

**è¿”å›JSONæ ¼å¼**:
{
  "intentAnalysis": {
    "userGoal": "ç”¨æˆ·çš„æ ¸å¿ƒæµ‹è¯•ç›®æ ‡",
    "testScope": "single-page|multi-page|full-site",
    "testType": "functional|ui|integration|e2e",
    "priority": "critical|high|medium|low",
    "estimatedDuration": "é¢„è®¡è€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰",
    "complexity": "simple|moderate|complex"
  },
  
  "pageAnalysis": {
    "websiteType": "ecommerce|social|corporate|saas|blog|other",
    "pageType": "homepage|product|cart|checkout|profile|article|list",
    "businessContext": "ä¸šåŠ¡åœºæ™¯æè¿°",
    "keyFeatures": ["æ ¸å¿ƒåŠŸèƒ½1", "æ ¸å¿ƒåŠŸèƒ½2"],
    "userJourney": ["ç”¨æˆ·è·¯å¾„æ­¥éª¤1", "æ­¥éª¤2"]
  },
  
  "testStrategy": {
    "testApproach": "è¯¦ç»†çš„æµ‹è¯•æ–¹æ³•",
    "testAreas": [
      {
        "area": "æµ‹è¯•åŒºåŸŸåç§°",
        "priority": 1-10,
        "reason": "ä¸ºä»€ä¹ˆè¦æµ‹è¯•è¿™ä¸ªåŒºåŸŸ",
        "elements": ["è¦æµ‹è¯•çš„å…ƒç´ ç±»å‹"],
        "validations": ["éªŒè¯ç‚¹"]
      }
    ],
    "testFlow": [
      {
        "step":  1,
        "description": "æµ‹è¯•æ­¥éª¤æè¿°",
        "expectedBehavior": "é¢„æœŸè¡Œä¸º",
        "criticalPath": true/false
      }
    ],
    "dataRequirements": {
      "mockData": {"å­—æ®µ":  "å»ºè®®çš„æµ‹è¯•æ•°æ®"},
      "dataScenarios": ["æ­£å¸¸æ•°æ®", "è¾¹ç•Œæ•°æ®", "å¼‚å¸¸æ•°æ®"]
    }
  },
  
  "recommendedConfig": {
    "testButtons": true/false,
    "testLinks": true/false,
    "testForms": true/false,
    "testModals": true/false,
    "testTables": true/false,
    "crossPageEnabled": true/false,
    "delay": æ¨èå»¶è¿Ÿæ¯«ç§’,
    "maxElements": æ¨èæœ€å¤§å…ƒç´ æ•°,
    "timeout": æ¨èè¶…æ—¶æ—¶é—´,
    "screenshot": true/false,
    "videoRecord": true/false
  },
  
  "potentialChallenges": [
    {
      "challenge": "å¯èƒ½çš„æŒ‘æˆ˜",
      "likelihood": "high|medium|low",
      "impact": "critical|high|medium|low",
      "mitigation": "åº”å¯¹ç­–ç•¥"
    }
  ],
  
  "successCriteria": [
    "æˆåŠŸæ ‡å‡†1ï¼šæ‰€æœ‰å…³é”®åŠŸèƒ½æ­£å¸¸å·¥ä½œ",
    "æˆåŠŸæ ‡å‡†2ï¼šæ— JavaScripté”™è¯¯",
    "æˆåŠŸæ ‡å‡†3ï¼šé¡µé¢å“åº”æ—¶é—´<3ç§’"
  ],
  
  "aiInsights": {
    "recommendations": ["å»ºè®®1", "å»ºè®®2"],
    "warnings": ["è­¦å‘Š1", "è­¦å‘Š2"],
    "optimizations": ["ä¼˜åŒ–å»ºè®®1"]
  }
}`;

    try {
      const result = await this.qwen.request([{
        role: 'system',
        content: 'ä½ æ˜¯ï¿½ï¿½ï¿½ä½æ‹¥æœ‰15å¹´ç»éªŒçš„é«˜çº§æµ‹è¯•å·¥ç¨‹å¸ˆï¼Œç²¾é€šWebè‡ªåŠ¨åŒ–æµ‹è¯•ã€ç”¨æˆ·ä½“éªŒæµ‹è¯•å’Œè´¨é‡ä¿éšœã€‚ä½ å–„äºä»ç”¨æˆ·çš„ç®€çŸ­æè¿°ä¸­ç†è§£æ·±å±‚éœ€æ±‚ï¼Œå¹¶ç»™å‡ºä¸“ä¸šã€å…¨é¢çš„æµ‹è¯•å»ºè®®ã€‚'
      }, {
        role: 'user',
        content: prompt
      }], {
        temperature: 0.3, // è¾ƒä½æ¸©åº¦ä¿è¯è¾“å‡ºç¨³å®š
        max_tokens:  4000
      });

      const intentPlan = this.parseResponse(result);
      
      // ä¿å­˜åˆ°å†å²è®°å½•
      this. intentHistory.push({
        input: userInput,
        plan: intentPlan,
        timestamp: new Date().toISOString()
      });

      console.log('[AIæ„å›¾å¼•æ“] âœ… æ„å›¾ç†è§£å®Œæˆ');
      console.log('[AIæ„å›¾å¼•æ“] æµ‹è¯•ç›®æ ‡:', intentPlan.intentAnalysis.userGoal);
      console.log('[AIæ„å›¾å¼•æ“] æµ‹è¯•èŒƒå›´:', intentPlan.intentAnalysis.testScope);
      
      return intentPlan;

    } catch (error) {
      console.error('[AIæ„å›¾å¼•æ“] âŒ æ„å›¾ç†è§£å¤±è´¥:', error);
      return this.fallbackPlan(userInput, pageContext);
    }
  }

  /**
   * è¾…åŠ©æ–¹æ³•ï¼šæ£€æµ‹é¡µé¢ç±»å‹
   */
  detectPageType(pageContext) {
    const url = pageContext.url. toLowerCase();
    const title = pageContext.title.toLowerCase();
    
    // åŸºäºURLå’Œæ ‡é¢˜çš„å¯å‘å¼è§„åˆ™
    if (url.includes('cart') || url.includes('checkout') || title.includes('è´­ç‰©è½¦')) {
      return 'è´­ç‰©è½¦/ç»“ç®—é¡µ';
    }
    if (url.includes('product') || url.includes('item') || title.includes('å•†å“')) {
      return 'å•†å“è¯¦æƒ…é¡µ';
    }
    if (url.includes('login') || url.includes('signin') || title.includes('ç™»å½•')) {
      return 'ç™»å½•é¡µ';
    }
    if (url.includes('register') || url.includes('signup') || title.includes('æ³¨å†Œ')) {
      return 'æ³¨å†Œé¡µ';
    }
    if (url === pageContext.origin || url === pageContext.origin + '/') {
      return 'é¦–é¡µ';
    }
    
    // åŸºäºé¡µé¢å…ƒç´ çš„æ£€æµ‹
    const hasForm = pageContext.forms?. length > 0;
    const hasTable = pageContext.tables?.length > 0;
    const hasManyLinks = pageContext.links?.length > 20;
    
    if (hasForm && ! hasManyLinks) return 'è¡¨å•é¡µ';
    if (hasTable) return 'åˆ—è¡¨é¡µ';
    if (hasManyLinks) return 'å¯¼èˆªé¡µ';
    
    return 'å†…å®¹é¡µ';
  }

  /**
   * è¾…åŠ©æ–¹æ³•ï¼šæ€»ç»“é¡µé¢å…ƒç´ 
   */
  summarizeElements(pageContext) {
    const summary = [];
    if (pageContext.forms?.length) summary.push(`${pageContext.forms.length}ä¸ªè¡¨å•`);
    if (pageContext.buttons?.length) summary.push(`${pageContext.buttons.length}ä¸ªæŒ‰é’®`);
    if (pageContext.links?.length) summary.push(`${pageContext.links.length}ä¸ªé“¾æ¥`);
    if (pageContext. inputs?.length) summary.push(`${pageContext.inputs.length}ä¸ªè¾“å…¥æ¡†`);
    if (pageContext.tables?.length) summary.push(`${pageContext.tables.length}ä¸ªè¡¨æ ¼`);
    if (pageContext.modals?.length) summary.push(`${pageContext.modals.length}ä¸ªå¼¹çª—`);
    
    return summary.join(', ') || 'æœªæ£€æµ‹åˆ°æ˜æ˜¾å…ƒç´ ';
  }

  /**
   * è§£æAIå“åº”
   */
  parseResponse(response) {
    try {
      const content = response.content || response;
      const jsonMatch = content.match(/\{[\s\S]*\}/);
      if (jsonMatch) {
        return JSON.parse(jsonMatch[0]);
      }
      throw new Error('æ— æ³•è§£æJSON');
    } catch (error) {
      console.error('[AIæ„å›¾å¼•æ“] JSONè§£æå¤±è´¥:', error);
      return this.fallbackPlan();
    }
  }

  /**
   * å¤‡ç”¨è®¡åˆ’ï¼ˆAIä¸å¯ç”¨æ—¶ï¼‰
   */
  fallbackPlan(userInput, pageContext) {
    return {
      intentAnalysis: {
        userGoal: userInput || "å…¨é¢åŠŸèƒ½æµ‹è¯•",
        testScope: "single-page",
        testType: "functional",
        priority: "medium",
        estimatedDuration:  "5-10åˆ†é’Ÿ",
        complexity: "moderate"
      },
      pageAnalysis: {
        websiteType: "other",
        pageType: this.detectPageType(pageContext),
        businessContext: "æœªçŸ¥ä¸šåŠ¡åœºæ™¯",
        keyFeatures: ["åŸºç¡€äº¤äº’"],
        userJourney: ["è®¿é—®é¡µé¢", "äº¤äº’æµ‹è¯•"]
      },
      testStrategy: {
        testApproach: "æ ‡å‡†è‡ªåŠ¨åŒ–æµ‹è¯•",
        testAreas: [{
          area: "æ‰€æœ‰å¯äº¤äº’å…ƒç´ ",
          priority:  5,
          reason: "è¦†ç›–åŸºç¡€åŠŸèƒ½",
          elements: ["button", "link", "input"],
          validations: ["å…ƒç´ å¯ç‚¹å‡»", "æ— JSé”™è¯¯"]
        }],
        testFlow: [],
        dataRequirements: {
          mockData: {},
          dataScenarios: ["æ­£å¸¸æ•°æ®"]
        }
      },
      recommendedConfig: {
        testButtons: true,
        testLinks: true,
        testForms: true,
        testModals: true,
        testTables: false,
        crossPageEnabled: false,
        delay: 800,
        maxElements: 100,
        timeout: 30000,
        screenshot: true,
        videoRecord: false
      },
      potentialChallenges: [],
      successCriteria: ["æ‰€æœ‰å…ƒç´ æµ‹è¯•é€šè¿‡"],
      aiInsights: {
        recommendations: ["å»ºè®®å¯ç”¨AIä»¥è·å¾—æ›´æ™ºèƒ½çš„æµ‹è¯•å»ºè®®"],
        warnings: ["å½“å‰ä½¿ç”¨é»˜è®¤é…ç½®"],
        optimizations: []
      }
    };
  }

  /**
   * åŸºäºå†å²ä¼˜åŒ–æ„å›¾ç†è§£
   */
  async refineIntentWithHistory(currentIntent, history) {
    if (history.length < 2) return currentIntent;

    const prompt = `åŸºäºç”¨æˆ·çš„å†å²æµ‹è¯•è®°å½•ï¼Œä¼˜åŒ–å½“å‰æµ‹è¯•è®¡åˆ’ã€‚

**å†å²è®°å½•**:
${history.slice(-3).map((h, i) => `
æµ‹è¯•${i+1}: 
- è¾“å…¥: ${h.input}
- æµ‹è¯•ç›®æ ‡: ${h.plan.intentAnalysis.userGoal}
- ç»“æœ: ${h.result?. success ? 'æˆåŠŸ' : 'å¤±è´¥'}
`).join('\n')}

**å½“å‰æµ‹è¯•è®¡åˆ’**: 
${JSON.stringify(currentIntent, null, 2)}

è¯·åˆ†æï¼š
1. ç”¨æˆ·çš„æµ‹è¯•ä¹ æƒ¯å’Œåå¥½
2. ä¹‹å‰æµ‹è¯•ä¸­çš„é—®é¢˜å’Œæ”¹è¿›ç‚¹
3. å¦‚ä½•ä¼˜åŒ–å½“å‰è®¡åˆ’ä»¥æé«˜æµ‹è¯•è´¨é‡

è¿”å›ä¼˜åŒ–åçš„æµ‹è¯•è®¡åˆ’JSONã€‚`;

    const result = await this.qwen. request([{
      role: 'user',
      content: prompt
    }]);

    return this.parseResponse(result);
  }
}

// å…¨å±€å®ä¾‹
if (typeof window !== 'undefined') {
  window.aiIntentEngine = null; // å»¶è¿Ÿåˆå§‹åŒ–
}
```

#### ç”¨æˆ·äº¤äº’æµç¨‹

```javascript
// popup.jsä¸­çš„é›†æˆ

async function startIntelligentTest() {
  // 1. è·å–ç”¨æˆ·è¾“å…¥çš„æµ‹è¯•æ„å›¾
  const userIntent = document.getElementById('testIntentInput').value;
  
  if (!userIntent) {
    showMessage('è¯·æè¿°æ‚¨æƒ³è¦æµ‹è¯•ä»€ä¹ˆ', 'warning');
    return;
  }

  showMessage('ğŸ¤– AIæ­£åœ¨ç†è§£æ‚¨çš„æµ‹è¯•æ„å›¾... ', 'info');
  
  // 2. åˆ†æå½“å‰é¡µé¢
  const [tab] = await chrome.tabs.query({ active: true, currentWindow: true });
  const pageContext = await analyzeCurrentPage(tab.id);
  
  // 3. AIç†è§£æ„å›¾å¹¶ç”Ÿæˆè®¡åˆ’
  const intentPlan = await window.aiIntentEngine.understandIntent(
    userIntent,
    pageContext
  );
  
  // 4. å‘ç”¨æˆ·å±•ç¤ºAIçš„ç†è§£å’Œè®¡åˆ’
  displayTestPlan(intentPlan);
  
  // 5. ç”¨æˆ·ç¡®è®¤æˆ–è°ƒæ•´
  const userConfirmed = await waitForUserConfirmation();
  
  if (userConfirmed) {
    // 6. æ‰§è¡Œæµ‹è¯•
    await executeTestWithPlan(intentPlan);
  }
}

function displayTestPlan(plan) {
  const planDisplay = `
    <div class="ai-plan-display">
      <h3>ğŸ¤– AIç†è§£çš„æµ‹è¯•è®¡åˆ’</h3>
      
      <div class="plan-section">
        <h4>æµ‹è¯•ç›®æ ‡</h4>
        <p>${plan.intentAnalysis.userGoal}</p>
      </div>
      
      <div class="plan-section">
        <h4>é¡µé¢åˆ†æ</h4>
        <p>ç½‘ç«™ç±»å‹: ${plan.pageAnalysis.websiteType}</p>
        <p>é¡µé¢ç±»å‹: ${plan.pageAnalysis.pageType}</p>
        <p>æ ¸å¿ƒåŠŸèƒ½: ${plan.pageAnalysis.keyFeatures.join(', ')}</p>
      </div>
      
      <div class="plan-section">
        <h4>æµ‹è¯•ç­–ç•¥</h4>
        <ul>
          ${plan.testStrategy.testAreas.map(area => 
            `<li><strong>${area.area}</strong> (ä¼˜å…ˆçº§: ${area.priority})<br/>
                <small>${area.reason}</small></li>`
          ).join('')}
        </ul>
      </div>
      
      <div class="plan-section">
        <h4>é¢„è®¡ç»“æœ</h4>
        <p>è€—æ—¶: ${plan.intentAnalysis.estimatedDuration}</p>
        <p>å¤æ‚åº¦: ${plan.intentAnalysis.complexity}</p>
      </div>
      
      <div class="plan-section ai-insights">
        <h4>ğŸ’¡ AIå»ºè®®</h4>
        <ul>
          ${plan.aiInsights.recommendations.map(rec => 
            `<li>${rec}</li>`
          ).join('')}
        </ul>
      </div>
    </div>
  `;
  
  document.getElementById('aiPlanContainer').innerHTML = planDisplay;
  document.getElementById('aiPlanContainer').style.display = 'block';
}
```

---

### ä¼˜åŒ–2:  æ™ºèƒ½æµ‹è¯•æ‰§è¡Œå¼•æ“ â­â­â­â­â­

#### æ ¸å¿ƒç†å¿µï¼šAIä½œä¸ºæµ‹è¯•æ‰§è¡Œçš„"å¤§è„‘"

ä¼ ç»Ÿè‡ªåŠ¨åŒ–æµ‹è¯•æ˜¯**é¢„å®šä¹‰è„šæœ¬**ï¼Œè€ŒAIé©±åŠ¨çš„æµ‹è¯•æ˜¯**æ™ºèƒ½æ¢ç´¢**ã€‚

```javascript
// æ–°æ–‡ä»¶: src/ai-execution-engine.js

/**
 * AIæ™ºèƒ½æµ‹è¯•æ‰§è¡Œå¼•æ“
 * æ ¸å¿ƒèŒè´£ï¼š
 * 1. åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­å®æ—¶åšå‡ºå†³ç­–
 * 2. åŠ¨æ€è°ƒæ•´æµ‹è¯•ç­–ç•¥
 * 3. æ™ºèƒ½å¤„ç†å¼‚å¸¸æƒ…å†µ
 * 4. ä¼˜åŒ–æµ‹è¯•è·¯å¾„
 */
class AIExecutionEngine {
  constructor(qwenApiKey, testPlan) {
    this.qwen = new QwenIntegration(qwenApiKey);
    this.testPlan = testPlan;
    this. executionContext = {
      startTime: Date.now(),
      currentPhase: 'initializing',
      testedElements: [],
      discoveredPages: [],
      decisions: [],
      anomalies: [],
      learnings: []
    };
  }

  /**
   * æ ¸å¿ƒæ–¹æ³•ï¼šæ™ºèƒ½æµ‹è¯•å†³ç­–
   * åœ¨æ¯ä¸ªå…³é”®èŠ‚ç‚¹ï¼ŒAIå†³å®šä¸‹ä¸€æ­¥åšä»€ä¹ˆ
   */
  async makeTestDecision(currentState) {
    const decisionPoint = {
      timestamp: Date.now(),
      pageUrl: currentState.url,
      testedCount: currentState.testedCount,
      totalElements: currentState.totalElements,
      discoveredNewPages: currentState.newPages,
      currentElement: currentState.currentElement,
      recentErrors: currentState.errors,
      timeElapsed: Date.now() - this.executionContext.startTime
    };

    console.log('[AIæ‰§è¡Œå¼•æ“] ğŸ¤” è¯·æ±‚AIå†³ç­–... ', decisionPoint);

    const prompt = `ä½ æ˜¯æµ‹è¯•æ‰§è¡Œçš„æ™ºèƒ½å†³ç­–å¼•æ“ã€‚è¯·åŸºäºå½“å‰çŠ¶æ€åšå‡ºæœ€ä¼˜å†³ç­–ã€‚

**æµ‹è¯•è®¡åˆ’**:
ç›®æ ‡: ${this.testPlan.intentAnalysis.userGoal}
èŒƒå›´: ${this. testPlan.intentAnalysis. testScope}
ä¼˜å…ˆçº§: ${this.testPlan.intentAnalysis.priority}

**å½“å‰çŠ¶æ€**:
- å½“å‰é¡µé¢: ${currentState.url}
- å·²æµ‹è¯•å…ƒç´ : ${currentState.testedCount}/${currentState.totalElements}
- æµ‹è¯•è¿›åº¦: ${Math.round((currentState.testedCount / currentState.totalElements) * 100)}%
- å·²è€—æ—¶: ${Math.round(decisionPoint.timeElapsed / 1000)}ç§’
- å‘ç°æ–°é¡µé¢: ${currentState.newPages.length}ä¸ª
- æœ€è¿‘é”™è¯¯: ${currentState. errors.length}ä¸ª

**å½“å‰å…ƒç´ ä¿¡æ¯**:
${currentState.currentElement ? `
- ç±»å‹: ${currentState.currentElement.type}
- æ–‡æœ¬: ${currentState.currentElement.text}
- é€‰æ‹©å™¨: ${currentState.currentElement.selector}
- é¢„è®¡è¡Œä¸º: ${this.predictBehavior(currentState.currentElement)}
` : 'æ— å½“å‰å…ƒç´ ï¼ˆå¯èƒ½åœ¨é¡µé¢åˆ‡æ¢ï¼‰'}

**å¯é€‰å†³ç­–**:
1. **CONTINUE** - ç»§ç»­æµ‹è¯•å½“å‰å…ƒç´ 
2. **SKIP** - è·³è¿‡å½“å‰å…ƒç´ 
3. **NAVIGATE** - å¯¼èˆªåˆ°æ–°å‘ç°çš„é¡µé¢
4. **RETRY** - é‡è¯•å¤±è´¥çš„æ“ä½œ
5. **PAUSE** - æš‚åœæµ‹è¯•åˆ†æé—®é¢˜
6. **COMPLETE** - è®¤ä¸ºæµ‹è¯•ç›®æ ‡å·²è¾¾æˆï¼Œå¯ä»¥ç»“æŸ
7. **ADJUST** - è°ƒæ•´æµ‹è¯•ç­–ç•¥

**å†³ç­–è€ƒè™‘å› ç´ **:
- å½“å‰å…ƒç´ æ˜¯å¦å…³é”®ï¼Ÿï¼ˆä¸æµ‹è¯•ç›®æ ‡çš„ç›¸å…³æ€§ï¼‰
- æ˜¯å¦æœ‰æ›´é«˜ä¼˜å…ˆçº§çš„å…ƒç´ æœªæµ‹è¯•ï¼Ÿ
- å‘ç°çš„æ–°é¡µé¢æ˜¯å¦éœ€è¦ç«‹å³æµ‹è¯•ï¼Ÿ
- é‡åˆ°çš„é”™è¯¯æ˜¯å¦å½±å“ç»§ç»­æµ‹è¯•ï¼Ÿ
- æµ‹è¯•æ˜¯å¦å·²ç»è¾¾åˆ°ç›®æ ‡ï¼Ÿ
- æ—¶é—´æˆæœ¬æ˜¯å¦åˆç†ï¼Ÿ

è¯·è¿”å›JSONå†³ç­–: 
{
  "decision": "CONTINUE|SKIP|NAVIGATE|RETRY|PAUSE|COMPLETE|ADJUST",
  "reasoning": "å†³ç­–ç†ç”±ï¼ˆè¯¦ç»†è¯´æ˜ä¸ºä»€ä¹ˆåšè¿™ä¸ªå†³å®šï¼‰",
  "confidence": 0-100,
  "priority": "critical|high|medium|low",
  "expectedOutcome": "é¢„æœŸç»“æœ",
  "alternativeActions": ["å¤‡é€‰æ–¹æ¡ˆ1", "å¤‡é€‰æ–¹æ¡ˆ2"],
  "riskAssessment": {
    "risk":  "è¯„ä¼°çš„é£é™©",
    "impact": "high|medium|low",
    "mitigation": "é£é™©ç¼“è§£æªæ–½"
  },
  "nextSteps": [
    {
      "action": "å…·ä½“æ“ä½œ",
      "reason": "ä¸ºä»€ä¹ˆè¦åšè¿™ä¸ªæ“ä½œ",
      "priority": 1-10
    }
  ],
  "optimizations": ["å¯ä»¥ä¼˜åŒ–çš„ç‚¹"],
  "warnings": ["éœ€è¦æ³¨æ„çš„é—®é¢˜"]
}`;

    try {
      const result = await this.qwen.request([{
        role: 'system',
        content: 'ä½ æ˜¯ä¸€ä½æ™ºèƒ½æµ‹è¯•å†³ç­–å¼•æ“ï¼Œéœ€è¦åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­åšå‡ºæœ€ä¼˜å†³ç­–ã€‚ä½ çš„ç›®æ ‡æ˜¯ä»¥æœ€é«˜æ•ˆçš„æ–¹å¼å®Œæˆæµ‹è¯•ç›®æ ‡ï¼ŒåŒæ—¶ä¿è¯æµ‹è¯•è´¨é‡ã€‚ä½ å–„äºæƒè¡¡æ•ˆç‡å’Œè¦†ç›–ç‡ï¼Œèƒ½å¤Ÿè¯†åˆ«å…³é”®æµ‹è¯•ç‚¹ã€‚'
      }, {
        role: 'user',
        content: prompt
      }], {
        temperature: 0.4, // é€‚ä¸­æ¸©åº¦ï¼Œå¹³è¡¡åˆ›é€ æ€§å’Œç¨³å®šæ€§
        max_tokens: 2000
      });

      const decision = this.parseResponse(result);
      
      // è®°å½•å†³ç­–
      this.executionContext.decisions.push({
        ... decision,
        timestamp: Date.now(),
        context: currentState
      });

      console.log('[AIæ‰§è¡Œå¼•æ“] âœ… å†³ç­–å®Œæˆ:', decision. decision);
      console.log('[AIæ‰§è¡Œå¼•æ“] ç†ç”±:', decision.reasoning);

      return decision;

    } catch (error) {
      console.error('[AIæ‰§è¡Œå¼•æ“] âŒ å†³ç­–å¤±è´¥:', error);
      return this.fallbackDecision(currentState);
    }
  }

  /**
   * æ™ºèƒ½å…ƒç´ ä¼˜å…ˆçº§æ’åº
   * AIè¯„ä¼°æ¯ä¸ªå…ƒç´ çš„æµ‹è¯•ä»·å€¼ï¼ŒåŠ¨æ€è°ƒæ•´æµ‹è¯•é¡ºåº
   */
  async prioritizeElements(elements, testGoal) {
    if (elements.length === 0) return [];
    if (elements.length === 1) return elements;

    console.log('[AIæ‰§è¡Œå¼•æ“] ğŸ¯ æ™ºèƒ½æ’åºæµ‹è¯•å…ƒç´ ...');

    // æ‰¹é‡è¯„ä¼°å…ƒç´ é‡è¦æ€§
    const elementsSummary = elements.slice(0, 50).map((el, idx) => ({
      index: idx,
      type: el.type,
      text: el.text,
      selector: el.selector,
      visible: el.visible,
      enabled: el.enabled
    }));

    const prompt = `è¯·ä¸ºä»¥ä¸‹å…ƒç´ è¯„ä¼°æµ‹è¯•ä¼˜å…ˆçº§ã€‚

**æµ‹è¯•ç›®æ ‡**: ${testGoal}

**å…ƒç´ åˆ—è¡¨**:
${JSON.stringify(elementsSummary, null, 2)}

**è¯„ä¼°æ ‡å‡†**:
1. ä¸æµ‹è¯•ç›®æ ‡çš„ç›¸å…³æ€§ï¼ˆæœ€é‡è¦ï¼‰
2. åŠŸèƒ½çš„å…³é”®æ€§ï¼ˆæ ¸å¿ƒåŠŸèƒ½ > è¾…åŠ©åŠŸèƒ½ï¼‰
3. ç”¨æˆ·ä½¿ç”¨é¢‘ç‡ï¼ˆé«˜é¢‘ > ä½é¢‘ï¼‰
4. ä¸šåŠ¡ä»·å€¼ï¼ˆé«˜ä»·å€¼ > ä½ä»·å€¼ï¼‰
5. é£é™©ç­‰çº§ï¼ˆé«˜é£é™© > ä½é£é™©ï¼‰

è¯·è¿”å›JSON: 
{
  "prioritizedIndexes": [å…ƒç´ ç´¢å¼•æŒ‰ä¼˜å…ˆçº§æ’åº],
  "reasoning": {
    "å…ƒç´ ç´¢å¼•": "ä¸ºä»€ä¹ˆè¿™ä¸ªå…ƒç´ é‡è¦"
  },
  "grouping": {
    "critical": [å…³é”®å…ƒç´ ç´¢å¼•],
    "high": [é«˜ä¼˜å…ˆçº§ç´¢å¼•],
    "medium": [ä¸­ä¼˜å…ˆçº§ç´¢å¼•],
    "low": [ä½ä¼˜å…ˆçº§ç´¢å¼•],
    "skip": [å¯è·³è¿‡çš„ç´¢å¼•]
  },
  "insights": "æ•´ä½“åˆ†æå’Œå»ºè®®"
}`;

    try {
      const result = await this.qwen.request([{
        role: 'user',
        content: prompt
      }], {
        temperature: 0.2, // ä½æ¸©åº¦ä¿è¯ä¸€è‡´æ€§
        max_tokens: 2000
      });

      const prioritization = this.parseResponse(result);
      
      // é‡æ–°æ’åºå…ƒç´ 
      const sortedElements = prioritization.prioritizedIndexes
        .map(idx => elements[idx])
        .filter(el => el); // è¿‡æ»¤undefined

      console.log('[AIæ‰§è¡Œå¼•æ“] âœ… å…ƒç´ ä¼˜å…ˆçº§æ’åºå®Œæˆ');
      console.log('[AIæ‰§è¡Œå¼•æ“] å…³é”®å…ƒç´ :', prioritization.grouping.critical. length);
      console.log('[AIæ‰§è¡Œå¼•æ“] å¯è·³è¿‡å…ƒç´ :', prioritization.grouping. skip.length);

      return sortedElements;

    } catch (error) {
      console.error('[AIæ‰§è¡Œå¼•æ“] å…ƒç´ æ’åºå¤±è´¥:', error);
      return elements; // å¤±è´¥æ—¶è¿”å›åŸé¡ºåº
    }
  }

  /**
   * æ™ºèƒ½å¼‚å¸¸å¤„ç†
   * å½“æµ‹è¯•é‡åˆ°é—®é¢˜æ—¶ï¼ŒAIåˆ†æå¹¶å°è¯•è‡ªåŠ¨ä¿®å¤
   */
  async handleAnomaly(anomaly) {
    console.log('[AIæ‰§è¡Œå¼•æ“] ğŸš¨ æ£€æµ‹åˆ°å¼‚å¸¸ï¼Œè¯·æ±‚AIè¯Šæ–­...');

    const prompt = `æµ‹è¯•è¿‡ç¨‹ä¸­é‡åˆ°å¼‚å¸¸ï¼Œéœ€è¦ä½ çš„è¯Šæ–­å’Œå¤„ç†å»ºè®®ã€‚

**å¼‚å¸¸ä¿¡æ¯**:
- ç±»å‹: ${anomaly.type}
- é”™è¯¯æ¶ˆæ¯: ${anomaly.error}
- å‘ç”Ÿä½ç½®: ${anomaly.location}
- å½“å‰å…ƒç´ : ${JSON.stringify(anomaly.element)}
- é¡µé¢çŠ¶æ€: ${JSON.stringify(anomaly.pageState)}

**å†å²ä¸Šä¸‹æ–‡**:
- ä¹‹å‰æµ‹è¯•è¿‡çš„å…ƒç´ : ${this.executionContext.testedElements.length}
- ä¹‹å‰é‡åˆ°çš„å¼‚å¸¸: ${this.executionContext.anomalies.length}
- ç›¸ä¼¼å¼‚å¸¸: ${this.findSimilarAnomalies(anomaly)}

**å¯é€‰å¤„ç†æ–¹æ¡ˆ**:
1. **RETRY** - é‡è¯•æ“ä½œï¼ˆå¯èƒ½æ˜¯ä¸´æ—¶é—®é¢˜ï¼‰
2. **SKIP** - è·³è¿‡è¯¥å…ƒç´ ç»§ç»­æµ‹è¯•
3. **WAIT** - ç­‰å¾…é¡µé¢ç¨³å®šåé‡è¯•
4. **NAVIGATE_BACK** - è¿”å›ä¸Šä¸€é¡µé¢
5. **RELOAD** - åˆ·æ–°é¡µé¢
6. **ADJUST_SELECTOR** - å°è¯•å…¶ä»–é€‰æ‹©å™¨
7. **ABORT** - ä¸­æ­¢æµ‹è¯•ï¼ˆä¸¥é‡é”™è¯¯ï¼‰

è¯·è¯Šæ–­é—®é¢˜æ ¹å› å¹¶ç»™å‡ºå¤„ç†æ–¹æ¡ˆï¼Œè¿”å›JSON:
{
  "diagnosis": {
    "rootCause": "æ ¹æœ¬åŸå› ",
    "category": "element-not-found|timeout|javascript-error|network-error|permission-denied|other",
    "severity": "critical|high|medium|low",
    "isRecoverable": true/false
  },
  "recommendedAction": {
    "action": "RETRY|SKIP|WAIT|NAVIGATE_BACK|RELOAD|ADJUST_SELECTOR|ABORT",
    "parameters": {
      "retryCount": é‡è¯•æ¬¡æ•°,
      "waitTime": ç­‰å¾…æ—¶é—´æ¯«ç§’,
      "alternativeSelector": "å¤‡ç”¨é€‰æ‹©å™¨"
    },
    "reasoning": "ä¸ºä»€ä¹ˆå»ºè®®è¿™ä¸ªæ–¹æ¡ˆ"
  },
  "preventionMeasures": [
    "é¢„é˜²æªæ–½1ï¼šå¢åŠ ç­‰å¾…æ—¶é—´",
    "é¢„é˜²æªæ–½2ï¼šä¼˜åŒ–é€‰æ‹©å™¨ç­–ç•¥"
  ],
  "learnings": [
    "ç»éªŒæ•™è®­1",
    "ç»éªŒæ•™è®­2"
  ]
}`;

    try {
      const result = await this.qwen.request([{
        role: 'system',
        content: 'ä½ æ˜¯ä¸€ä½ç»éªŒä¸°å¯Œçš„æµ‹è¯•å·¥ç¨‹å¸ˆï¼Œæ“…é•¿è¯Šæ–­å’Œè§£å†³è‡ªåŠ¨åŒ–æµ‹è¯•ä¸­çš„å„ç§é—®é¢˜ã€‚ä½ èƒ½å¿«é€Ÿå®šä½é—®é¢˜æ ¹å› ï¼Œå¹¶ç»™å‡ºå®ç”¨çš„è§£å†³æ–¹æ¡ˆã€‚'
      }, {
        role: 'user',
        content: prompt
      }], {
        temperature: 0.3,
        max_tokens: 2000
      });

      const solution = this.parseResponse(result);
      
      // è®°å½•å¼‚å¸¸å’Œè§£å†³æ–¹æ¡ˆ
      this. executionContext.anomalies. push({
        anomaly,
        solution,
        timestamp:  Date.now()
      });

      console.log('[AIæ‰§è¡Œå¼•æ“] âœ… å¼‚å¸¸è¯Šæ–­å®Œæˆ');
      console.log('[AIæ‰§è¡Œå¼•æ“] æ ¹å› :', solution.diagnosis.rootCause);
      console.log('[AIæ‰§è¡Œå¼•æ“] å»ºè®®æ“ä½œ:', solution.recommendedAction. action);

      return solution;

    } catch (error) {
      console.error('[AIæ‰§è¡Œå¼•æ“] å¼‚å¸¸è¯Šæ–­å¤±è´¥:', error);
      return this.fallbackAnomalyHandling(anomaly);
    }
  }

  /**
   * æµ‹è¯•è·¯å¾„ä¼˜åŒ–
   * AIåˆ†ææµ‹è¯•è·¯å¾„ï¼Œæ‰¾åˆ°æœ€ä¼˜æµ‹è¯•é¡ºåº
   */
  async optimizeTestPath(pages, testGoal) {
    console.log('[AIæ‰§è¡Œå¼•æ“] ğŸ—ºï¸ ä¼˜åŒ–æµ‹è¯•è·¯å¾„...');

    const prompt = `è¯·ä¼˜åŒ–è·¨é¡µé¢æµ‹è¯•è·¯å¾„ã€‚

**æµ‹è¯•ç›®æ ‡**: ${testGoal}

**å‘ç°çš„é¡µé¢**:
${pages.map((p, i) => `${i+1}. ${p. url} - ${p.title}`).join('\n')}

**å½“å‰æµ‹è¯•è·¯å¾„**: 
${pages.map((p, i) => `${i+1}. ${p.url}`).join(' â†’ ')}

**ä¼˜åŒ–ç›®æ ‡**:
1. æœ€å°åŒ–é¡µé¢è·³è½¬æ¬¡æ•°
2. ä¼˜å…ˆæµ‹è¯•å…³é”®ä¸šåŠ¡æµç¨‹
3. è€ƒè™‘é¡µé¢é—´çš„ä¾èµ–å…³ç³»
4. æé«˜æµ‹è¯•æ•ˆç‡

è¯·è¿”å›JSON:
{
  "optimizedPath": [
    {
      "pageIndex": é¡µé¢ç´¢å¼•,
      "url": "é¡µé¢URL",
      "reason": "ä¸ºä»€ä¹ˆåœ¨è¿™ä¸ªä½ç½®æµ‹è¯•",
      "dependencies": [ä¾èµ–çš„å‰ç½®é¡µé¢ç´¢å¼•],
      "estimatedDuration": "é¢„è®¡æµ‹è¯•æ—¶é—´"
    }
  ],
  "pathReasoning": "æ•´ä½“è·¯å¾„è®¾è®¡ç†ç”±",
  "efficiencyGain": "ç›¸æ¯”åŸè·¯å¾„çš„æ•ˆç‡æå‡",
  "criticalPath": [å…³é”®è·¯å¾„çš„é¡µé¢ç´¢å¼•],
  "optionalPages": [å¯é€‰é¡µé¢ç´¢å¼•]
}`;

    try {
      const result = await this. qwen.request([{
        role: 'user',
        content: prompt
      }]);

      const optimizedPath = this.parseResponse(result);
      
      console.log('[AIæ‰§è¡Œå¼•æ“] âœ… è·¯å¾„ä¼˜åŒ–å®Œæˆ');
      console.log('[AIæ‰§è¡Œå¼•æ“] æ•ˆç‡æå‡:', optimizedPath. efficiencyGain);

      return optimizedPath;

    } catch (error) {
      console.error('[AIæ‰§è¡Œå¼•æ“] è·¯å¾„ä¼˜åŒ–å¤±è´¥:', error);
      return { optimizedPath: pages. map((p, i) => ({ pageIndex: i, url: p. url })) };
    }
  }

  /**
   * å®æ—¶è´¨é‡è¯„ä¼°
   * æµ‹è¯•è¿‡ç¨‹ä¸­æŒç»­è¯„ä¼°æµ‹è¯•è´¨é‡
   */
  async assessTestQuality(currentResults) {
    const qualityMetrics = {
      coverage: (currentResults.testedElements / currentResults.totalElements) * 100,
      successRate: (currentResults.successCount / currentResults.testedElements) * 100,
      errorRate: (currentResults.errorCount / currentResults.testedElements) * 100,
      duration: Date.now() - this.executionContext.startTime,
      pagesVisited: currentResults.visitedPages.length
    };

    const prompt = `è¯„ä¼°å½“å‰æµ‹è¯•è´¨é‡ã€‚

**æµ‹è¯•æŒ‡æ ‡**:
- è¦†ç›–ç‡: ${qualityMetrics.coverage.toFixed(2)}%
- æˆåŠŸç‡: ${qualityMetrics.successRate.toFixed(2)}%
- é”™è¯¯ç‡: ${qualityMetrics.errorRate. toFixed(2)}%
- å·²è€—æ—¶: ${(qualityMetrics.duration / 1000).toFixed(0)}ç§’
- è®¿é—®é¡µé¢:  ${qualityMetrics.pagesVisited}ä¸ª

**æµ‹è¯•ç›®æ ‡**: ${this.testPlan.intentAnalysis.userGoal}

è¯·è¯„ä¼°ï¼š
1. å½“å‰æµ‹è¯•è´¨é‡å¦‚ä½•ï¼Ÿ
2. æ˜¯å¦è¾¾åˆ°äº†æµ‹è¯•ç›®æ ‡ï¼Ÿ
3. æ˜¯å¦éœ€è¦ç»§ç»­æµ‹è¯•ï¼Ÿ
4. æœ‰å“ªäº›æ”¹è¿›ç©ºé—´ï¼Ÿ

è¿”å›JSON: 
{
  "qualityScore": 0-100,
  "qualityLevel": "excellent|good|fair|poor",
  "goalAchievement": 0-100,
  "shouldContinue": true/false,
  "recommendations": [
    {
      "type": "improvement|warning|info",
      "message": "å»ºè®®å†…å®¹",
      "priority": "high|medium|low"
    }
  ],
  "missingAreas": ["æœªè¦†ç›–çš„æµ‹è¯•åŒºåŸŸ"],
  "overTestedAreas": ["è¿‡åº¦æµ‹è¯•çš„åŒºåŸŸ"]
}`;

    try {
      const result = await this.qwen.request([{
        role: 'user',
        content:  prompt
      }]);

      const assessment = this.parseResponse(result);
      
      console.log('[AIæ‰§è¡Œå¼•æ“] ğŸ“Š è´¨é‡è¯„ä¼°:', assessment.qualityLevel);
      console.log('[AIæ‰§è¡Œå¼•æ“] ç›®æ ‡è¾¾æˆåº¦:', assessment.goalAchievement + '%');

      return assessment;

    } catch (error) {
      console.error('[AIæ‰§è¡Œå¼•æ“] è´¨é‡è¯„ä¼°å¤±è´¥:', error);
      return {
        qualityScore: 70,
        qualityLevel: 'fair',
        shouldContinue: true,
        recommendations: []
      };
    }
  }

  // è¾…åŠ©æ–¹æ³•
  parseResponse(response) {
    try {
      const content = response.content || response;
      const jsonMatch = content.match(/\{[\s\S]*\}/);
      return jsonMatch ?  JSON.parse(jsonMatch[0]) : {};
    } catch (error) {
      console.error('[AIæ‰§è¡Œå¼•æ“] å“åº”è§£æå¤±è´¥:', error);
      return {};
    }
  }

  predictBehavior(element) {
    if (element.type === 'link') return 'é¡µé¢è·³è½¬';
    if (element.type === 'button' && element.text. includes('æäº¤')) return 'è¡¨å•æäº¤';
    if (element.type === 'button' && element.text.includes('åˆ é™¤')) return 'åˆ é™¤æ“ä½œ';
    if (element.type === 'input') return 'æ•°æ®è¾“å…¥';
    if (element.type === 'select') return 'é€‰é¡¹é€‰æ‹©';
    return 'äº¤äº’æ“ä½œ';
  }

  findSimilarAnomalies(anomaly) {
    const similar = this.executionContext.anomalies.filter(a => 
      a.anomaly.type === anomaly.type || 
      a.anomaly. error. includes(anomaly.error. substring(0, 30))
    );
    return similar.length + 'æ¬¡ç›¸ä¼¼å¼‚å¸¸';
  }

  fallbackDecision(currentState) {
    return {
      decision: 'CONTINUE',
      reasoning: 'AIä¸å¯ç”¨ï¼Œä½¿ç”¨é»˜è®¤ç­–ç•¥ç»§ç»­æµ‹è¯•',
      confidence: 50,
      priority: 'medium',
      expectedOutcome: 'ç»§ç»­æµ‹è¯•å½“å‰å…ƒç´ ',
      alternativeActions: ['SKIP'],
      riskAssessment: { risk: 'æœªçŸ¥', impact: 'low', mitigation: 'äººå·¥ç›‘æ§' },
      nextSteps: [{ action: 'æµ‹è¯•ä¸‹ä¸€ä¸ªå…ƒç´ ', reason: 'ä¿æŒæµ‹è¯•è¿›åº¦', priority: 5 }],
      optimizations: [],
      warnings: ['AIå†³ç­–ä¸å¯ç”¨']
    };
  }

  fallbackAnomalyHandling(anomaly) {
    return {
      diagnosis: {
        rootCause:  'æœªçŸ¥',
        category: 'other',
        severity: 'medium',
        isRecoverable:  true
      },
      recommendedAction: {
        action: 'SKIP',
        parameters: {},
        reasoning: 'AIä¸å¯ç”¨ï¼Œé€‰æ‹©è·³è¿‡è¯¥å…ƒç´ '
      },
      preventionMeasures: [],
      learnings: []
    };
  }
}
```

---

### ä¼˜åŒ–3:  AIå¢å¼ºçš„æµ‹è¯•æ•°æ®ç”Ÿæˆç³»ç»Ÿ â­â­â­â­

#### é—®é¢˜ï¼šæµ‹è¯•æ•°æ®è´¨é‡ç›´æ¥å½±å“æµ‹è¯•æ•ˆæœ

```javascript
// æ–°æ–‡ä»¶:  src/ai-data-generator.js

/**
 * AIæ™ºèƒ½æµ‹è¯•æ•°æ®ç”Ÿæˆå™¨
 * æ ¸å¿ƒèŒè´£ï¼š
 * 1. ç†è§£è¡¨å•å­—æ®µçš„è¯­ä¹‰å’Œä¸šåŠ¡å«ä¹‰
 * 2. ç”Ÿæˆç¬¦åˆçœŸå®ä¸šåŠ¡åœºæ™¯çš„æµ‹è¯•æ•°æ®
 * 3. ç”Ÿæˆè¾¹ç•Œå€¼å’Œå¼‚å¸¸æ•°æ®ç”¨äºå¥å£®æ€§æµ‹è¯•
 * 4. ä¿æŒè·¨é¡µé¢æ•°æ®çš„ä¸€ï¿½ï¿½æ€§
 */
class AIDataGenerator {
  constructor(qwenApiKey) {
    this.qwen = new QwenIntegration(qwenApiKey);
    this.dataCache = new Map(); // ç¼“å­˜ç”Ÿæˆçš„æ•°æ®
    this.contextData = new Map(); // è·¨é¡µé¢æ•°æ®ä¸Šä¸‹æ–‡
  }

  /**
   * æ™ºèƒ½è¡¨å•æ•°æ®ç”Ÿæˆ
   */
  async generateFormData(formInfo, businessContext) {
    console.log('[AIæ•°æ®ç”Ÿæˆå™¨] ğŸ² ç”Ÿæˆæ™ºèƒ½æµ‹è¯•æ•°æ®...');

    const prompt = `ä½ æ˜¯æµ‹è¯•æ•°æ®ç”Ÿæˆä¸“å®¶ã€‚è¯·ä¸ºè¡¨å•ç”Ÿæˆé«˜è´¨é‡çš„æµ‹è¯•æ•°æ®ã€‚

**ä¸šåŠ¡åœºæ™¯**:  ${businessContext || 'é€šç”¨åœºæ™¯'}

**è¡¨å•å­—æ®µ**:
${JSON.stringify(formInfo. fields, null, 2)}

**æ•°æ®è¦æ±‚**:
1. **çœŸå®æ€§** - æ•°æ®å¿…é¡»ç¬¦åˆçœŸå®ä¸šåŠ¡åœºæ™¯
2. **åˆæ³•æ€§** - æ•°æ®å¿…é¡»é€šè¿‡å­—æ®µéªŒè¯è§„åˆ™
3. **å¤šæ ·æ€§** - æä¾›å¤šç»„ä¸åŒçš„æµ‹è¯•æ•°æ®
4. **å®Œæ•´æ€§** - è€ƒè™‘å­—æ®µé—´çš„å…³è”å…³ç³»

**ç‰¹æ®Šè€ƒè™‘**:
- ä¸­å›½ç”¨æˆ·ä¹ æƒ¯ï¼ˆæ‰‹æœºå·ã€èº«ä»½è¯ã€åœ°å€ç­‰ï¼‰
- å¸¸è§ä¸šåŠ¡è§„åˆ™ï¼ˆé‚®ç®±æ ¼å¼ã€å¯†ç å¼ºåº¦ç­‰ï¼‰
- è¾¹ç•Œå€¼æµ‹è¯•ï¼ˆæœ€å¤§é•¿åº¦ã€æœ€å°å€¼ç­‰ï¼‰
- å¼‚å¸¸æ•°æ®æµ‹è¯•ï¼ˆç‰¹æ®Šå­—ç¬¦ã€SQLæ³¨å…¥ç­‰ï¼‰

è¯·ç”Ÿæˆä»¥ä¸‹å‡ ç±»æµ‹è¯•æ•°æ®ï¼š

è¿”å›JSON:
{
  "normalScenarios": [
    {
      "scenarioName": "åœºæ™¯åç§°ï¼ˆå¦‚ï¼šæ™®é€šç”¨æˆ·æ³¨å†Œï¼‰",
      "description": "åœºæ™¯æè¿°",
      "data": {
        "å­—æ®µå": "å­—æ®µå€¼",
        ... 
      },
      "expectedResult": "é¢„æœŸç»“æœ"
    }
  ],
  "edgeCases": [
    {
      "caseName": "è¾¹ç•Œç”¨ä¾‹åç§°ï¼ˆå¦‚ï¼šæœ€é•¿ç”¨æˆ·åï¼‰",
      "description": "ç”¨ä¾‹æè¿°",
      "data": {},
      "expectedResult": "é¢„æœŸç»“æœ"
    }
  ],
  "errorScenarios": [
    {
      "scenarioName": "é”™è¯¯åœºæ™¯åç§°ï¼ˆå¦‚ï¼šæ— æ•ˆé‚®ç®±ï¼‰",
      "description": "åœºæ™¯æè¿°",
      "data": {},
      "expectedError": "é¢„æœŸé”™è¯¯æç¤º"
    }
  ],
  "specialCases": [
    {
      "caseName": "ç‰¹æ®Šç”¨ä¾‹ï¼ˆå¦‚ï¼šXSSæ³¨å…¥æµ‹è¯•ï¼‰",
      "description":  "ç”¨ä¾‹æè¿°",
      "data": {},
      "purpose": "æµ‹è¯•ç›®çš„"
    }
  ],
  "dataInsights": {
    "recommendations": ["æ•°æ®å»ºè®®"],
    "warnings": ["æ³¨æ„äº‹é¡¹"],
    "businessRules": ["è¯†åˆ«åˆ°çš„ä¸šåŠ¡è§„åˆ™"]
  }
}`;

    try {
      const result = await this. qwen.request([{
        role: 'system',
        content: 'ä½ æ˜¯ä¸€ä½èµ„æ·±çš„æµ‹è¯•æ•°æ®å·¥ç¨‹å¸ˆï¼Œç²¾é€šå„ç§ä¸šåŠ¡åœºæ™¯çš„æµ‹è¯•æ•°æ®è®¾è®¡ã€‚ä½ ç‰¹åˆ«äº†è§£ä¸­å›½äº’è”ç½‘äº§å“çš„æ•°æ®è§„åˆ™å’Œç”¨æˆ·ä¹ æƒ¯ã€‚'
      }, {
        role:  'user',
        content:  prompt
      }], {
        temperature: 0.6, // é€‚ä¸­æ¸©åº¦ï¼Œä¿è¯æ•°æ®å¤šæ ·æ€§
        max_tokens:  3000
      });

      const testData = this.parseResponse(result);
      
      // ç¼“å­˜æ•°æ®ä»¥ä¾›åç»­ä½¿ç”¨
      this. dataCache.set(formInfo. formId, testData);

      console.log('[AIæ•°æ®ç”Ÿæˆå™¨] âœ… æµ‹è¯•æ•°æ®ç”Ÿæˆå®Œæˆ');
      console.log('[AIæ•°æ®ç”Ÿæˆå™¨] æ­£å¸¸åœºæ™¯:', testData.normalScenarios.length);
      console.log('[AIæ•°æ®ç”Ÿæˆå™¨] è¾¹ç•Œç”¨ä¾‹:', testData.edgeCases. length);
      console.log('[AIæ•°æ®ç”Ÿæˆå™¨] é”™è¯¯åœºæ™¯:', testData. errorScenarios.length);

      return testData;

    } catch (error) {
      console.error('[AIæ•°æ®ç”Ÿæˆå™¨] æ•°æ®ç”Ÿæˆå¤±è´¥:', error);
      return this.fallbackDataGeneration(formInfo);
    }
  }

  /**
   * å•å­—æ®µæ™ºèƒ½æ•°æ®ç”Ÿæˆ
   */
  async generateFieldData(fieldInfo) {
    const cacheKey = `${fieldInfo.name}_${fieldInfo.type}`;
    if (this.dataCache.has(cacheKey)) {
      return this.dataCache.get(cacheKey);
    }

    const prompt = `ä¸ºå•ä¸ªå­—æ®µç”Ÿæˆæµ‹è¯•æ•°æ®ã€‚

**å­—æ®µä¿¡æ¯**:
- åç§°: ${fieldInfo.name}
- ç±»å‹: ${fieldInfo.type}
- æ ‡ç­¾: ${fieldInfo.label}
- å ä½ç¬¦: ${fieldInfo.placeholder}
- å¿…å¡«: ${fieldInfo.required}
- éªŒè¯è§„åˆ™: ${JSON.stringify(fieldInfo.validation)}

è¯·åˆ†æå­—æ®µè¯­ä¹‰å¹¶ç”Ÿæˆåˆé€‚çš„æµ‹è¯•æ•°æ®ã€‚

è¿”å›JSON:
{
  "semantic": "å­—æ®µè¯­ä¹‰ï¼ˆå¦‚ï¼šemail|phone|username|password|address|name|ageç­‰ï¼‰",
  "normalValues": ["æ­£å¸¸å€¼1", "æ­£å¸¸å€¼2", "æ­£å¸¸å€¼3"],
  "edgeValues": ["è¾¹ç•Œå€¼1", "è¾¹ç•Œå€¼2"],
  "invalidValues": ["æ— æ•ˆå€¼1", "æ— æ•ˆå€¼2"],
  "recommendation": "æ¨èä½¿ç”¨çš„å€¼",
  "reasoning": "ä¸ºä»€ä¹ˆæ¨èè¿™ä¸ªå€¼"
}`;

    try {
      const result = await this.qwen.request([{
        role: 'user',
        content: prompt
      }], {
        temperature: 0.4,
        max_tokens: 1000
      });

      const fieldData = this.parseResponse(result);
      this.dataCache.set(cacheKey, fieldData);

      return fieldData;

    } catch (error) {
      console.error('[AIæ•°æ®ç”Ÿæˆå™¨] å­—æ®µæ•°æ®ç”Ÿæˆå¤±è´¥:', error);
      return this.fallbackFieldData(fieldInfo);
    }
  }

  /**
   * è·¨é¡µé¢æ•°æ®ä¸€è‡´æ€§ç»´æŠ¤
   */
  async maintainDataConsistency(currentPageData, previousPageData, businessFlow) {
    console.log('[AIæ•°æ®ç”Ÿæˆå™¨] ğŸ”„ ç»´æŠ¤è·¨é¡µé¢æ•°æ®ä¸€è‡´æ€§...');

    const prompt = `åˆ†æè·¨é¡µé¢æ•°æ®å…³ç³»ï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§ã€‚

**ä¸šåŠ¡æµç¨‹**:  ${businessFlow}

**å‰é¢é¡µé¢çš„æ•°æ®**:
${JSON. stringify(previousPageData, null, 2)}

**å½“å‰é¡µé¢éœ€è¦å¡«å†™**:
${JSON.stringify(currentPageData. fields, null, 2)}

è¯·åˆ†æï¼š
1. å“ªäº›å­—æ®µéœ€è¦ä½¿ç”¨å‰é¢é¡µé¢çš„æ•°æ®ï¼Ÿ
2. æ•°æ®å¦‚ä½•æ˜ å°„å’Œè½¬æ¢ï¼Ÿ
3. æ˜¯å¦éœ€è¦ç”Ÿæˆæ–°æ•°æ®ï¼Ÿ

è¿”å›JSON:
{
  "fieldMappings": [
    {
      "currentField": "å½“å‰å­—æ®µå",
      "sourceField": "æ¥æºå­—æ®µå",
      "sourcePage": "æ¥æºé¡µé¢",
      "transformation": "æ•°æ®è½¬æ¢è§„åˆ™",
      "value": "æ˜ å°„åçš„å€¼"
    }
  ],
  "newDataNeeded": {
    "å­—æ®µå": "æ–°ç”Ÿæˆçš„å€¼"
  },
  "consistencyRules": ["ä¸€è‡´æ€§è§„åˆ™1", "è§„åˆ™2"],
  "warnings": ["æ½œåœ¨çš„æ•°æ®ä¸ä¸€è‡´é—®é¢˜"]
}`;

    try {
      const result = await this.qwen.request([{
        role: 'user',
        content: prompt
      }]);

      const consistency = this.parseResponse(result);
      
      console.log('[AIæ•°æ®ç”Ÿæˆå™¨] âœ… æ•°æ®ä¸€è‡´æ€§åˆ†æå®Œæˆ');
      console.log('[AIæ•°æ®ç”Ÿæˆå™¨] å­—æ®µæ˜ å°„:', consistency.fieldMappings.length);

      return consistency;

    } catch (error) {
      console.error('[AIæ•°æ®ç”Ÿæˆå™¨] ä¸€è‡´æ€§åˆ†æå¤±è´¥:', error);
      return { fieldMappings: [], newDataNeeded: {} };
    }
  }

  /**
   * æ™ºèƒ½å¯†ç ç”Ÿæˆ
   */
  generateSecurePassword(requirements) {
    // åŸºäºè¦æ±‚ç”Ÿæˆç¬¦åˆè§„åˆ™çš„å¯†ç 
    const chars = {
      lowercase: 'abcdefghijklmnopqrstuvwxyz',
      uppercase: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
      numbers: '0123456789',
      special: '!@#$%^&*()_+-=[]{}|;:,.<>?'
    };

    let password = '';
    const length = requirements.minLength || 8;

    // ç¡®ä¿åŒ…å«æ‰€éœ€å­—ç¬¦ç±»å‹
    if (requirements.requireLowercase) password += this.randomChar(chars.lowercase);
    if (requirements.requireUppercase) password += this.randomChar(chars. uppercase);
    if (requirements. requireNumber) password += this.randomChar(chars.numbers);
    if (requirements.requireSpecial) password += this.randomChar(chars.special);

    // å¡«å……åˆ°æ‰€éœ€é•¿åº¦
    const allChars = Object.values(chars).join('');
    while (password.length < length) {
      password += this.randomChar(allChars);
    }

    // æ‰“ä¹±é¡ºåº
    return password.split('').sort(() => Math.random() - 0.5).join('');
  }

  /**
   * ç”Ÿæˆä¸­å›½æ‰‹æœºå·
   */
  generateChinesePhoneNumber() {
    const prefixes = ['130', '131', '132', '133', '134', '